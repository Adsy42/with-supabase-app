#!/bin/sh

# Get current branch name
branch=$(git symbolic-ref --short HEAD)

# Allowed branch patterns
# - main, develop (protected branches)
# - release/*, hotfix/* (special branches)
# - type/description (conventional branches)
valid_pattern="^(main|develop|release\/[a-z0-9.-]+|hotfix\/[a-z0-9.-]+|(feat|fix|docs|style|refactor|perf|test|chore|ci|revert)\/[a-z0-9-]+)$"

if ! echo "$branch" | grep -Eq "$valid_pattern"; then
  echo "‚ùå Invalid branch name: '$branch'"
  echo ""
  echo "Branch names must follow the pattern: <type>/<description>"
  echo ""
  echo "Valid types: feat, fix, docs, style, refactor, perf, test, chore, ci, revert"
  echo "Description: lowercase letters, numbers, and hyphens only"
  echo ""
  echo "Examples:"
  echo "  feat/user-profile"
  echo "  fix/login-redirect"
  echo "  chore/update-deps"
  echo ""
  echo "To rename your branch:"
  echo "  git branch -m $branch <new-name>"
  echo ""
  exit 1
fi
